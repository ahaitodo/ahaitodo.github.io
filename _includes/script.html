{%- assign buildAt = site.time | date: "%Y%m%d%H%M%S" -%}
<script type="text/javascript" src="{{site.baseurl}}/static/js/blog.js?t={{ buildAt }}"></script>
<script type="text/javascript" src="{{site.baseurl}}/static/js/search.js?t={{ buildAt }}"></script>

{%- if site.extClickEffect %}
<!-- 点击页面文字冒出特效 -->
<script>
;(function(){
  var textArr = ['富强', '民主', '文明', '和谐', '自由', '平等', '公正', '法治', '爱国', '敬业', '诚信', '友善']
  window.blog.initClickEffect(textArr)
})()
</script>
{% endif %}

{%- if page.layout=="mypost" or page.layout=="post" -%}
  {%- if site.extMath -%}
    {% include ext-mathjax.html %}
  {% elsif page.extMath %}
    {% include ext-mathjax.html %}
  {% endif %}
{% endif %}

{%- if site.extCount %}
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
{% endif %}

{%- if site.extCount %}
<script>
  // Fallback: if busuanzi didn't populate counts after 2.5s, keep a safe `0` value
  (function () {
    function isNumberText(s) {
      return typeof s === 'string' && /\d+/.test(s.trim());
    }
    function ensureCounts() {
      try {
        var page = document.getElementById('busuanzi_value_page_pv');
        var site = document.getElementById('busuanzi_value_site_pv');
        if (page && !isNumberText(page.textContent)) page.textContent = '0';
        if (site && !isNumberText(site.textContent)) site.textContent = '0';
      } catch (e) {}
    }
    // check a couple times in case script loads slowly
    setTimeout(ensureCounts, 1200);
    setTimeout(ensureCounts, 2500);
  })();
</script>
{%- endif %}
